import pytest
import QR

def test_gram_schmidt():
    assert QR.gram_schmidt([[1,0],[1,1]]) == [[[1,0],[0,1]],
                                                 [[1,0],[1,1]]]
    assert QR.gram_schmidt([[1,0],[-3,-3]]) == [[[1,0],[0,-1]],
                                                   [[1,0],[-3,3]]]
                                                   
                                                   
                                
def test_orthonormalize():
    assert QR.orthonormalize([[1,0],[1,1]]) == [[1,0],[0,1]]
    assert QR.orthonormalize([[1,0],[-3,-3]]) == [[1,0],[0,-1]]
    
    
    
def test_householder():
    matrix_f = [[1,1,1], [-1,4,4], [4,-2,0]]
    matrix_γ = [[1,2,3],[-3,5,9],[1,-2,0]]
    assert QR.householder(matrix_f) == ([[[-0.577350269189626, -0.5773502691896258, -0.5773502691896258], [0.8164965809277259, -0.4082482904638628, -0.408248290463863], [5.551115123125783e-17, 0.7071067811865475, -0.7071067811865476]], [[-1.7320508075688776, 1.5700924586837747e-16, 1.232595164407831e-32], [-4.041451884327381, -4.0824829046386295, -4.440892098500626e-16], [-1.1547005383792521, 4.0824829046386295, -1.414213562373095]]])
    assert QR.householder(matrix_γ) == ([[[-0.2672612419124245, -0.5345224838248489, -0.8017837257372733], [0.9532825604327254, -0.025086383169282078, -0.3010365980313868], [-0.14079697633917954, 0.8447818580350775, -0.5162555799103252]], [[-3.741657386773942, 7.920012943087602e-16, -1.1697621683624575e-16], [-9.08688222502243, -5.694608979427069, -1.3322676295501878e-15], [0.8017837257372733, 1.0034553267712896, -1.8303606924093345]]])
